# Neovim Git工具使用指南

这个指南介绍了集成在Neovim中的Git工具集，帮助您高效地进行Git操作、查看历史和比较差异。

## 插件组合

我们使用以下插件组合提供完整的Git功能：

1. **gitsigns.nvim** - 行内变更指示和基本Git操作
2. **diffview.nvim** - 高级差异查看和历史浏览
3. **neogit** - 类似Magit的全功能Git界面
4. **vim-flog** - Git日志浏览器
5. **vim-fugitive** - 核心Git功能

## 常用快捷键

### Gitsigns - 行内变更和基本操作

行内变更会在编辑器侧边栏显示添加、修改和删除的标记。

| 快捷键 | 功能 |
|--------|------|
| `]c` | 跳转到下一个变更 |
| `[c` | 跳转到上一个变更 |
| `<leader>gs` | 暂存当前变更块 |
| `<leader>gr` | 重置当前变更块 |
| `<leader>gS` | 暂存整个文件 |
| `<leader>gu` | 撤销暂存变更块 |
| `<leader>gR` | 重置整个文件 |
| `<leader>gp` | 预览变更块 |
| `<leader>gb` | 显示当前行的完整归属信息 |
| `<leader>gtb` | 开关当前行归属信息显示 |
| `<leader>gd` | 与索引比较差异 |
| `<leader>gD` | 与HEAD比较差异 |
| `<leader>gtd` | 切换删除行显示 |

在可视模式下：
| 快捷键 | 功能 |
|--------|------|
| `<leader>gs` | 暂存选中区域 |
| `<leader>gr` | 重置选中区域 |

文本对象：
| 快捷键 | 功能 |
|--------|------|
| `ih` | 选择当前变更块 |

### Diffview - 差异查看和文件历史

| 快捷键 | 功能 |
|--------|------|
| `<leader>gv` | 打开差异查看器 |
| `<leader>gh` | 查看版本库文件历史 |
| `<leader>gH` | 查看当前文件历史 |

在Diffview中：
- 使用`q`关闭窗口
- 使用`<tab>`和`<S-tab>`在差异之间导航
- 使用`j`和`k`在文件列表中移动
- 使用`<CR>`打开选定文件
- 使用`o`展开/折叠目录
- 使用`R`刷新

### Neogit - 综合Git界面

| 快捷键 | 功能 |
|--------|------|
| `<leader>gg` | 打开Neogit |

在Neogit中（常用操作）：
- 使用`tab`展开/折叠部分
- 使用`s`暂存文件/块
- 使用`u`取消暂存
- 使用`c`提交
- 使用`P`推送
- 使用`L`拉取
- 使用`d`查看差异
- 使用`?`查看帮助

### Vim-Flog - Git日志浏览

| 快捷键 | 功能 |
|--------|------|
| `<leader>gl` | 打开Git日志浏览器 |

### Vim-Fugitive - 基础Git命令

| 快捷键 | 功能 |
|--------|------|
| `<leader>gB` | 显示文件归属信息（blame） |
| `<leader>gc` | Git提交 |
| `<leader>gP` | Git推送 |
| `<leader>gL` | Git拉取 |

## 常见使用场景

### 查看提交历史

1. 使用`<leader>gg`打开Neogit
2. 导航到日志部分
3. 或使用`<leader>gl`打开Flog
4. 或使用`<leader>gh`打开Diffview文件历史

### 查看文件变更

1. 使用`<leader>gv`打开Diffview
2. 或在文件中使用`]c`和`[c`在变更之间跳转
3. 使用`<leader>gp`预览当前变更

### 暂存和提交更改

1. 使用`<leader>gs`暂存单个变更块
2. 使用`<leader>gS`暂存整个文件
3. 使用`<leader>gc`开始提交流程

### 查看文件归属信息

1. 将光标移动到感兴趣的行
2. 使用`<leader>gb`查看详细归属信息
3. 或使用`<leader>gB`打开全文件归属视图

## 提示和技巧

1. **增量暂存** - 使用gitsigns的`<leader>gs`暂存特定变更块，而不是整个文件
2. **快速浏览历史** - 使用diffview的`<leader>gH`查看当前文件的历史
3. **可视化差异** - 使用`<leader>gd`快速查看您的更改
4. **智能导航** - 使用`]c`和`[c`快速导航文件中的变更
5. **丰富的上下文** - 启用行归属信息帮助理解代码来源

## 高级用法

### 交互式变基 (通过Neogit)

1. 打开Neogit (`<leader>gg`)
2. 导航到相关提交
3. 按下`r`开始变基
4. 选择要编辑的提交
5. 执行变基操作

### 冲突解决 (通过Diffview)

1. 在合并冲突期间，使用`<leader>gv`打开diffview
2. 使用三方差异视图查看和解决冲突
3. 文件解决后提交更改

### 部分提交 (通过Gitsigns)

1. 使用可视模式选择要暂存的行
2. 使用`<leader>gs`暂存选择内容
3. 使用`<leader>gc`提交暂存内容 